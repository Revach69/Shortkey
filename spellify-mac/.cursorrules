# Spellify - Cursor AI Rules

## üìö Read These Documents Before Making ANY Changes

**CRITICAL: Always read and follow these documents:**

1. **`docs/BEST_PRACTICES.md`** - Code style, conventions, and patterns
2. **`docs/ARCHITECTURE.md`** - System design and structure
3. **`docs/FEATURES.md`** - Feature specifications
4. **`docs/DEVELOPMENT.md`** - Development workflow

---

## üéØ Core Rules (Must Follow)

### Localization
- ‚ùå **NEVER use hardcoded strings** in production code
- ‚úÖ **ALWAYS use** `Strings.swift` for user-facing text
- ‚úÖ **ALWAYS use** `Constants.swift` for non-translatable values

### File Size
- ‚úÖ Keep files **< 150 lines** (preferred)
- ‚úÖ Max **200 lines** absolute limit
- ‚úÖ If larger, **break into small components** under a new folder

### Component Structure
- ‚úÖ One component per file
- ‚úÖ Single Responsibility Principle
- ‚úÖ Group related components in subfolders
- ‚úÖ **Domain Models** go in `Models/` (app-wide use)
- ‚úÖ **DTOs** stay in service folders (internal use only)
- ‚úÖ **Services** are stateless (no @Published)
- ‚úÖ **Managers** are stateful (ObservableObject)

### Code Quality
- ‚úÖ Follow **SOLID principles**
- ‚úÖ Follow **Apple HIG**
- ‚úÖ Add **SwiftUI previews**
- ‚úÖ Use **proper MARK sections**

### Comments & Documentation
- ‚úÖ Comments explain **WHY**, never **WHAT**
- ‚ùå **NEVER add trivial comments** that repeat the code
- ‚úÖ Only comment when explaining non-obvious logic or decisions
- ‚úÖ Clear naming is better than comments

---

## üìñ Examples in Codebase

### Perfect Component Examples:
- `Views/Sheets/ActionEditor/ActionIconPicker.swift` - Small, focused component
- `Views/Sheets/ActionEditor/ActionNameField.swift` - Simple input field
- `Views/Settings/Components/ConnectionStatusRow.swift` - Display component

### Perfect Manager Examples:
- `Managers/ActionsManager.swift` - CRUD with persistence (ObservableObject)
- `Managers/SubscriptionManager/` - Folder structure for complex managers

### Perfect Service Examples:
- `Services/KeychainService.swift` - Simple stateless service
- `Services/SpellifyBackend/` - Folder structure for complex services

### Perfect Model Examples:
- `Models/QuotaInfo.swift` - Domain model with rich logic (in Models/)
- `Services/SpellifyBackend/BackendResponseModels.swift` - DTOs (in service folder)

---

## üö´ Anti-Patterns (Never Do)

```swift
// ‚ùå BAD: Hardcoded strings
Text("Save")
Button("Delete")

// ‚ùå BAD: Magic numbers
.padding(17)

// ‚ùå BAD: Trivial comments (repeating what code does)
/// Can user add more actions?
var canAddAction: Bool { ... }

/// Updates an existing action
func update(_ action: SpellAction) { ... }

// ‚ùå BAD: Large files (> 200 lines)
struct HugeView: View {
    // 300+ lines
}
```

---

## ‚úÖ Correct Patterns (Always Do)

```swift
// ‚úÖ GOOD: Localized strings
Text(Strings.ActionEditor.save)
Button(Strings.Common.delete)

// ‚úÖ GOOD: Use constants
.padding(Constants.standardPadding)

// ‚úÖ GOOD: Clear naming (no comment needed!)
var canAddAction: Bool { ... }
func update(_ action: SpellAction) { ... }

// ‚úÖ GOOD: Comments explain WHY, not WHAT
// Debounce saves to avoid excessive writes
DispatchQueue.main.asyncAfter(deadline: .now() + 0.1, execute: workItem)

// All Pro features require subscription (policy decision)
return isProUser

// ‚úÖ GOOD: Small, focused components
struct HeaderView: View {
    // 40 lines max
}
```

---

## üîÑ Workflow

**Before writing ANY code:**
1. Read `docs/BEST_PRACTICES.md`
2. Check similar components in codebase
3. Follow existing patterns
4. Keep it small and focused

**When asked to create a component:**
1. Check if similar component exists
2. Follow its structure
3. Use Strings.swift for text
4. Keep < 150 lines
5. Add preview

**When asked to refactor:**
1. Break large files into small components
2. Extract hardcoded strings to Strings.swift
3. Move magic numbers to Constants.swift
4. Follow patterns in docs/BEST_PRACTICES.md

---

## üéì Learn from Existing Code

**Good component structure:**
```
Views/Sheets/ActionEditor/
‚îú‚îÄ‚îÄ ActionEditorHeader.swift      (35 lines)
‚îú‚îÄ‚îÄ ActionIconPicker.swift        (67 lines)
‚îú‚îÄ‚îÄ ActionNameField.swift         (39 lines)
‚îú‚îÄ‚îÄ ActionPromptEditor.swift      (59 lines)
‚îî‚îÄ‚îÄ ActionEditorFooter.swift      (79 lines)
```

**Main file is just a coordinator:**
```
Views/Sheets/
‚îî‚îÄ‚îÄ ActionEditorSheet.swift       (118 lines - composes components)
```

---

## üìù Remember

- **Read the docs** before every change
- **Follow existing patterns** in the codebase
- **Keep it simple** and focused
- **No hardcoded strings** ever
- **Small components** always
- **Comments explain WHY, not WHAT** - clear naming beats comments

---

**Documentation is the source of truth. When in doubt, check the docs!**
